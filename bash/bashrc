# ~/.bashrc - user-specific Bash settings
#
# This file is sourced by all *interactive* bash shells on startup,
# including some apparently interactive shells such as scp and rcp
# that can't tolerate any output.  So make sure this doesn't display
# anything or bad things will happen !


# Test for an interactive shell.  There is no need to set anything
# past this point for scp and rcp, and it's important to refrain from
# outputting anything in those cases.
if [[ $- != *i* ]] ; then
	# Shell is non-interactive.  Be done now!
	return
fi


# Put your fun stuff here.


# The pattern "**" used in a pathname expansion context will match
# all files and zero or more directories and subdirectories.
shopt -s globstar

# Setup a useful history
export HISTCONTROL=ignoreboth
export HISTFILESIZE=10000
export HISTSIZE=10000

# Preferred tools
export PAGER=/usr/bin/most
export EDITOR=/usr/bin/vim
export BROWSER=$HOME/.local/bin/vimb

# Extend the paths to the .local directories
path prepend -e bin ~/.local/bin ~/.gem/ruby/1.9.1/bin
path append -e bin /usr/local/sbin /usr/sbin /sbin
path prepend -e lib ~/.local/lib64 ~/.local/lib
path prepend -e inc ~/.local/include
path prepend -e pkc ~/.local/lib/pkgconfig
path prepend -e man ~/.local/share/man
path append -e man /usr/share/man

# Source some useful Bash modules
export BASH_MODULES_SCRIPT="$HOME/Code/Quentin/scripts/github/bash/modules/bashmod"
source $BASH_MODULES_SCRIPT
bashmod ssh
bashmod gnupg
bashmod display

# Add Git key-less SSH keys to the SSH agent
SSH_AGENT_AUTOKEYS=(~/.ssh/git@github.rsa)
ssh-agent-test ~/.ssh/agent-thaleee && ssh-add "${SSH_AGENT_AUTOKEYS[@]}" &> /dev/null || ssh-agent-respawn ~/.ssh/agent-thaleee

# Start or discover the GPG agent
export GPG_TTY=$(tty)
gpg-agent-test ~/.gnupg/agent-thaleee || gpg-agent --daemon --write-env-file ~/.gnupg/agent-thaleee
. ~/.gnupg/agent-thaleee
export GPG_AGENT_INFO

# Setup wcd
export WCDHOME=~/.wcd
wcd ()
{
    local gofile="${WCDHOME:-${HOME}}/bin/wcd.go"
    rm -f "$gofile"
    wcd.exec "$@"
    [[ -f "$gofile" ]] && source "$gofile"
}

# Default to no display when the X server is remote (this greatly improves Vim startup time over slow connections)
[[ "$DISPLAY" == "localhost:"* ]] && nodisplay

# If available, setup some useful aliases
[[ -f ~/.bash_aliases ]] && . ~/.bash_aliases

# Greet the user
[[ -f ~/.bash_greetings ]] && . ~/.bash_greetings

